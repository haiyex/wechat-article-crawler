# 微信公众号文章抓取工具 - 需求说明书

## 1. 项目概述

### 1.1 项目背景
开发一个命令行工具，用于从指定微信公众号获取所有历史文章，并将文章内容保存为Markdown格式文件。

### 1.2 项目目标
- 实现微信公众号文章的自动抓取
- 提取文章的完整信息（标题、链接、发布日期、正文内容）
- 下载并保存文章中的图片
- 将文章保存为结构化的Markdown文件

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 公众号文章抓取
- 输入公众号名称或ID
- 自动获取该公众号的所有历史文章列表
- 支持分页获取，确保获取全部文章

#### 2.1.2 文章内容提取
- 提取文章标题
- 提取文章链接（原始URL）
- 提取文章发布日期
- 提取文章正文内容（包括文本、格式）
- 识别并提取文章中的所有图片链接

#### 2.1.3 图片下载
- 批量下载文章中的图片
- 图片按文章分类存储
- 图片文件名保持唯一性

#### 2.1.4 Markdown文件生成
- 为每篇文章生成独立的Markdown文件
- 文件名格式：`YYYY-MM-DD-标题.md`
- Markdown文件包含：
  - 文章元数据（标题、链接、日期）
  - 文章正文内容（保持原有格式）
  - 图片引用（使用相对路径）

### 2.2 辅助功能

#### 2.2.1 命令行参数
- 支持指定公众号名称/ID
- 支持指定输出目录
- 支持指定文章数量限制
- 显示抓取进度

#### 2.2.2 错误处理
- 网络错误重试机制
- 公众号不存在或无文章时的提示
- 图片下载失败的处理

## 3. 非功能需求

### 3.1 性能要求
- 支持并发下载图片，提高效率
- 单篇文章处理时间不超过3秒

### 3.2 可靠性
- 具备异常处理能力
- 支持断点续传（记录已抓取的文章）
- 错误信息清晰可读

### 3.3 易用性
- 提供清晰的使用说明
- 命令行参数直观易懂
- 进度显示友好

## 4. 技术约束

### 4.1 技术栈
- 编程语言：Python 3.8+
- 第三方库：requests, beautifulsoup4, wechatsogou（或类似库）

### 4.2 数据来源
- 使用搜狗搜索API获取微信公众号文章（wechatsogou）

### 4.3 数据存储
- 本地文件系统
- Markdown格式文件
- 图片按目录分类存储

## 5. 数据格式

### 5.1 Markdown文件结构
```markdown
# [标题]

**原始链接**: [链接]
**发布日期**: [日期]

---
[正文内容]

---
*文章自动抓取于 [抓取时间]*
```

### 5.2 目录结构
```
output/
├── 公众号名称/
│   ├── 2024-01-15-文章标题1.md
│   ├── 2024-01-14-文章标题2.md
│   └── images/
│       ├── 文章标题1_img1.jpg
│       ├── 文章标题1_img2.jpg
│       └── 文章标题2_img1.jpg
```

## 6. 约束与限制

### 6.1 技术限制
- 微信公众号反爬虫机制可能导致抓取失败
- 搜狗搜索API可能有访问频率限制
- 部分公众号可能设置了访问限制

### 6.2 法律合规
- 仅用于个人学习和研究
- 不得用于商业用途
- 尊重原创者版权
- 遵守微信公众平台服务条款

## 7. 验收标准

- [ ] 能够成功获取指定公众号的文章列表
- [ ] 能够正确提取文章标题、链接、日期和正文内容
- [ ] 能够成功下载文章中的图片
- [ ] 生成的Markdown文件格式正确，包含所有必要信息
- [ ] 图片引用路径正确
- [ ] 命令行参数功能正常
- [ ] 错误处理机制完善
- [ ] 进度显示清晰
